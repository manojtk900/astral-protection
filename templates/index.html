<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>ASTRAL PROTECTION — URL Detection</title>

<script src="https://cdn.tailwindcss.com"></script>

<style>
body {
  background: linear-gradient(135deg,#0f172a,#1e293b,#0f172a);
}
.glass {
  background: rgba(255,255,255,0.05);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255,255,255,0.08);
}
.glow-safe {
  box-shadow: 0 0 20px rgba(16,185,129,0.6);
}
.glow-bad {
  box-shadow: 0 0 20px rgba(239,68,68,0.6);
}
.fade-in {
  animation: fadeIn 0.5s ease forwards;
}
@keyframes fadeIn {
  from {opacity:0; transform:translateY(10px);}
  to {opacity:1; transform:translateY(0);}
}
</style>
</head>

<body class="text-white min-h-screen flex flex-col">

<!-- Header -->
<header class="flex justify-between items-center p-6">
  <h1 class="text-2xl font-bold bg-gradient-to-r from-indigo-400 to-cyan-400 bg-clip-text text-transparent">
    ASTRAL PROTECTION
  </h1>

  <nav class="space-x-6 text-gray-300">
    <a href="/home" class="hover:text-white">Home</a>
    <a href="/" class="text-white font-semibold">Detection</a>
    <a href="/about" class="hover:text-white">About</a>
    <a href="/interface" class="bg-emerald-500 px-4 py-2 rounded-lg hover:bg-emerald-600 text-white">
      AI ChatBot
    </a>
  </nav>
</header>

<!-- Main -->
<main class="flex-grow flex items-center justify-center px-4">

  <div class="glass rounded-2xl p-10 w-full max-w-2xl text-center">

    <h2 class="text-3xl font-bold mb-4">
      AI Powered Phishing URL Detection
    </h2>

    <p class="text-gray-400 mb-8">
      Enter a website URL and let our ML model analyze its safety.
    </p>

    <!-- Form -->
    <form method="POST" action="/" class="space-y-4">

      <input name="url"
             type="text"
             value="{{ submitted_url or '' }}"
             placeholder="https://example.com"
             class="w-full p-3 rounded-lg bg-gray-800 border border-gray-600 focus:border-indigo-500 outline-none text-white">

      <button type="submit"
              class="w-full bg-indigo-600 hover:bg-indigo-700 py-3 rounded-lg font-semibold transition">
        Scan URL
      </button>
    </form>

    <!-- Result Section -->
    {% if predict %}
    <div class="mt-8 fade-in">

      {% if predict.status == "safe" %}
        <div class="p-4 rounded-xl bg-green-500/20 glow-safe">
          <h3 class="text-xl font-bold text-green-400">
            SAFE ✅
          </h3>
          <p class="text-gray-300 mt-2">{{ predict.message }}</p>
        </div>

      {% elif predict.status == "malicious" %}
        <div class="p-4 rounded-xl bg-red-500/20 glow-bad">
          <h3 class="text-xl font-bold text-red-400">
            PHISHING ⚠️
          </h3>
          <p class="text-gray-300 mt-2">{{ predict.message }}</p>
        </div>

      {% else %}
        <div class="p-4 rounded-xl bg-gray-700">
          <p>{{ predict.message }}</p>
        </div>
      {% endif %}

      <!-- Confidence Bar (Safe Jinja Version) -->
      {% if predict.get('debug') %}
        {% set details = predict.get('debug').get('details') %}
        {% if details and details.get('proba') %}
          {% set prob = (details.get('proba')[0].get('top_prob') * 100) | round(2) %}

          <div class="mt-6 text-left">
            <p class="text-sm text-gray-400 mb-2">Model Confidence</p>

            <div class="w-full bg-gray-700 rounded-full h-4">
              <div class="h-4 rounded-full bg-indigo-500"
                   style="width:{{ prob }}%">
              </div>
            </div>

            <p class="text-right text-sm mt-1 text-gray-400">
              {{ prob }}%
            </p>
          </div>

        {% endif %}
      {% endif %}

    </div>
    {% endif %}

  </div>

</main>

<!-- Footer -->
<footer class="text-center text-gray-500 py-6 text-sm">
  © 2026 ASTRAL PROTECTION — Built with ❤️ by Manoj T K
</footer>

</body>
</html>